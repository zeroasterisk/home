#!/bin/sh

# directory where dotfiles repo lives
SRC="${HOME}/dotfiles"

red="\033[31m"
green="\033[32m"
yellow="\033[33m"
blue="\033[34m"
reset="\033[0m"


ensure_dir() {
    if [ ! -d "$1" ]; then
	mkdir -p "$1"
    fi
}
check_file() {
    if ! which "$1" >/dev/null; then
        echo " ${yellow}${1}${reset} % ${red}is not available${reset}"
    elif [ -e "$2" ]; then
        if [ -L "$2" ]; then
            echo " ${yellow}${2}${reset} % ${blue}is already symlinked${reset}"
        else
            echo " ${yellow}${2}${reset} % ${red}is no symlink${reset}"
        fi
    else
        ln -sf "$3" "$2"
        echo " ${yellow}${2}${reset} % ${green}-> ${3}${reset}"
    fi
}


# first, just make sure some dirs exist (not symlinked)
{
    ensure_dir ~/.config/nvim
    ensure_dir ~/tmp


    check_file  gem       ~/.gemrc                         ${SRC}/gem/gemrc
    check_file  git       ~/.git                           ${SRC}/git
    check_file  git       ~/.gitconfig                     ${SRC}/git/gitconfig
    check_file  gitk      ~/.gitk                          ${SRC}/git/gitk
    check_file  tmux      ~/.tmux.conf                     ${SRC}/tmux/.tmux.conf
    check_file  true      ~/.terminfo                      ${SRC}/terminfo
    check_file  true      ~/.asdf                          ${SRC}/asdf
    check_file  true      ~/bin                            ${SRC}/bin
    check_file  vim       ~/.vim                           ${SRC}/vim
    check_file  vim       ~/.vimrc                         ${SRC}/vim/vimrc
    check_file  vim       ~/.config/nvim/init.vim          ${SRC}/config/nvim/init.vim
    check_file  zsh       ~/.zsh                           ${SRC}/zsh
    check_file  zsh       ~/.zshrc                         ${SRC}/zsh/zshrc

    # other stuff I usually don't need
    # --------------------------------
    # check_file  zsh       ~/.zsh_alias.tmx2                         ${SRC}/zsh/.zsh_alias.tmx2
    # consider other custom zsh files...?
    #zsh_alias
    #zsh_alias.docker
    #zsh_alias.osx
    #zsh_config
    #zsh_config.osx
    #zsh_path
    #zsh_path.osx

    # other stuff I usually don't need, but good prompts
    # --------------------------------
    #check_file  bochs     ~/.bochsrc                       ${SRC}/bochs/bochsrc
    #check_file  cmus      ~/.cmus/kuku.theme               ${SRC}/cmus/kuku.theme
    #check_file  conky     ~/.conkyrc                       ${SRC}/conky/conkyrc
    #check_file  emacs     ~/.emacs.d                       ${SRC}/emacs.d
    #check_file  firefox   ~/.mozilla                       ${SRC}/mozilla
    #check_file  gdb       ~/.gdbinit                       ${SRC}/gdb/gdbinit
    #check_file  getmail   ~/.getmail                       ${SRC}/getmail
    #check_file  gpg       ~/.gnupg                         ${SRC}/gnupg
    #check_file  hg        ~/.hgrc                          ${SRC}/hg/hgrc
    #check_file  irssi     ~/.irssi                         ${SRC}/irssi
    #check_file  liferea   ~/.liferea_1.8                   ${SRC}/liferea/liferea_1.8
    #check_file  liferea   ~/feedlist.opml                  ${SRC}/liferea/feedlist.opml
    #check_file  msmtp     ~/.msmtprc                       ${SRC}/msmtp/msmtprc
    #check_file  mutt      ~/.muttrc                        ${SRC}/mutt/muttrc
    #check_file  true      ~/.pentadactyl                   ${SRC}/pentadactyl
    #check_file  true      ~/.pentadactylrc                 ${SRC}/pentadactyl/pentadactylrc
    #check_file  xmonad    ~/.xmonad                        ${SRC}/xmonad
    #check_file  zsh       ~/.zshenv                        ${SRC}/zsh/zshenv

} | column -t -s %
